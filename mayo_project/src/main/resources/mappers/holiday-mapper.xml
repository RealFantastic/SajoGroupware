<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="Holiday">

	<select id="holidayEmpList" resultType="HolidayEmployee">
		SELECT EMP_NO
			, EMP_NAME
			, PHONE
			,(SELECT dept_name FROM department b WHERE b.dept_no=a.dept_no) DEPT_NM
			,(SELECT job_name FROM job b WHERE b.job_no=a.job_no) JOB_NM
			,(SELECT left_count FROM employee_holiday b WHERE b.emp_no=a.emp_no) LEFT_COUNT
		FROM employee a order by EMP_NO
	</select>
	<insert id="insertHoliday" parameterType="Holiday">
		INSERT INTO HOLIDAY_HISTORY 
		VALUES
		(
		(SELECT NVL(MAX(HD_NO),0)+1 FROM HOLIDAY_HISTORY)
		, #{emp_no}, default, #{hd_start}, #{hd_end}, #{hd_code}
		, #{hd_count}, #{hd_reason}, #{ea_no}
		)
	</insert>
	<!-- 선택한 결재문서의 내용  -->
	<select id="selectHoliday" parameterType="string" resultType="Holiday">
		SELECT * FROM HOLIDAY_HISTORY WHERE EA_NO=#{ea_no}
	</select>
</mapper>
